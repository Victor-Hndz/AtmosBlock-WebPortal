import{j as e,e as s,f as a,g as t,h as l,i as n,k as r,Q as o,U as i,W as d,X as c,Y as m,Z as u,_ as h,$ as p,a0 as x,a1 as f,a2 as v,a3 as b,a4 as g,a5 as j,a6 as N,a7 as y,a8 as T,a9 as w,aa as C,ab as I,ac as A,ad as q,n as S,o as F,p as E,q as M,b as L,B as O,D,E as P,G as k,H as _,V as $}from"./ui-DsGTuYJt.js";import{b as G,r as U,l as H}from"./vendor-DMwOp_gx.js";import{j as V,n as B,C as W,o as R,p as z,i as Y,A as X,q as K,X as Q,r as Z,s as J,t as ee,u as se,v as ae,I as te,T as le,h as ne}from"./icons-Cb89orYe.js";import{a as re,u as oe,b as ie,s as de}from"./index-B-JNh-Hw.js";import{u as ce}from"./i18n-BPcgiOnt.js";import{u as me}from"./useAuth-BxhRuCYj.js";const ue=G.memo((({t:s})=>e.jsx("div",{className:"auth-alert bg-amber-50 border-l-4 border-amber-400 p-4 mb-6 rounded-md",role:"alert",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-5 w-5 text-amber-500 flex-shrink-0"}),e.jsx("p",{className:"ml-3 text-sm text-amber-800 font-medium",children:s("requests-form.anonymousWarning","You are not logged in. Your request will be processed anonymously.")})]})}))),he=["basicInfo","mapConfig","additionalSettings","summary"],pe=["1000","550","500","300","100","10"],xe=[...pe,"850","700","200","50"].sort(((e,s)=>{const a=parseInt(e);return parseInt(s)-a})),fe=Array.from({length:(new Date).getFullYear()-2e3},((e,s)=>`${2e3+s}`)),ve=Array.from({length:(new Date).getFullYear()-1940},((e,s)=>`${1940+s}`)),be=["january","february","march","april","may","june","july","august","september","october","november","december"],ge=e=>be.findIndex((s=>s===e)),je=(e,s)=>{if(!e.length||!s.length)return[];if(1===e.length&&1===s.length){return((e,s)=>Array.from({length:new Date(e,s+1,0).getDate()},((e,s)=>`${s+1}`)))(parseInt(e[0]),ge(s[0]))}const a=new Set;return s.forEach((s=>{const t=ge(s);let l=0;e.forEach((e=>{const s=parseInt(e),a=new Date(s,t+1,0).getDate();l=Math.max(l,a)}));for(let e=1;e<=l;e++)a.add(String(e))})),Array.from(a).sort(((e,s)=>parseInt(e)-parseInt(s)))},Ne=Array.from({length:24},((e,s)=>s.toString()));function ye(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Te(e){const s=new Date(Date.parse(e+" 1, 2020")).getMonth();return s>=0?String(s+1):"-1"}const we=(e,s)=>{return(a=e??[],a.map((e=>{const s=parseInt(e,10)-1;return s<0||s>11?"Invalid Month":new Date(2020,s).toLocaleString("en",{month:"long"})}))).map((e=>s(`months-list.${e.toLowerCase()}`))).join(", ");var a},Ce=(e,s)=>e&&0!==e.length?e.map((e=>{const s=Number(e);return s<10?`0${s}`:`${s}`})).join(", "):s("common.none"),Ie=(e,s)=>e&&0!==e.length?e.map((e=>{const s=Number(e);return s<10?`0${s}:00`:`${s}:00`})).join(", "):s("common.none"),Ae=(e,s)=>e&&0!==e.length?e.map((e=>`${Number(e)}hPa`)).join(", "):s("common.none"),qe=(e,s)=>e&&0!==e.length?e.join(", "):s("common.none"),Se=(e,s)=>e&&0!==e.length?e.map((e=>s(`mapTypes-list.${e.toLowerCase()}`))).join(", "):s("common.none"),Fe=G.memo((({formData:s,onPrevious:a,t:t})=>{const l=U.useMemo((()=>{var a;const l=(null==(a=s.years)?void 0:a.join(", "))??"",n=s.months,r=s.days,o=s.hours,i=s.mapTypes,d=s.fileFormat??t("common.none"),c=[{label:t("requests-form.variableName"),value:ye(s.variableName??"")||t("common.none")},{label:t("requests-form.years"),value:l||t("common.none")},{label:t("requests-form.months"),value:we(n,t)||t("common.none")},{label:t("requests-form.days"),value:Ce(r,t)},{label:t("requests-form.hours"),value:Ie(o,t)},{label:t("requests-form.pressureLevels"),value:Ae(s.pressureLevels,t)||t("common.none")},{label:t("requests-form.areaCovered"),value:qe(s.areaCovered,t)||t("common.none")},{label:t("requests-form.mapTypes"),value:Se(i,t)||t("common.none")},{label:t("requests-form.fileFormat"),value:d.toUpperCase()||t("common.none")}];return e.jsxs("div",{className:"bg-slate-50 rounded-lg p-5 border border-slate-200",children:[e.jsx("p",{className:"text-slate-700 mb-4",children:t("requests-titles.reviewBeforeSubmit")}),e.jsx("div",{className:"space-y-3",children:c.map((s=>e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[s.label,":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:s.value})]},s.label)))}),(s.mapLevels&&s.mapLevels.length>0||s.noData||s.noMaps||s.omp||s.nThreads||s.mpi||s.nProces)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[e.jsx("h3",{className:"text-md font-medium text-slate-700 mb-3",children:t("requests-form.options")}),e.jsxs("div",{className:"space-y-3",children:[s.noData&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.skipData"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.yes","Yes")})]}),s.mapLevels&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.mapLevels"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:s.mapLevels.join(", ")})]}),s.noMaps&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.skipMapGeneration"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.yes","Yes")})]}),s.omp&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.openMP"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.enabled","Enabled")})]}),s.nThreads&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.useMultipleThreads"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.yes","Yes")})]}),s.mpi&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.mpi"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.enabled","Enabled")})]}),s.nProces&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-700",children:[t("requests-form.useMultipleProcesses"),":"]}),e.jsx("div",{className:"text-sm text-slate-600",children:t("requests-form.yes","Yes")})]})]})]})]})}),[s,t]),n=U.useMemo((()=>e.jsx("button",{type:"button",onClick:a,className:"mt-6 px-4 py-2 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-slate-700 \n                bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2\n                transition-colors duration-200",children:t("buttons.back")})),[a,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:t("requests-titles.summary")}),l,n]})}));var Ee=(e=>(e.TEXT="text",e.NUMBER="number",e.CHECKBOX="checkbox",e.SELECT="select",e.MULTISELECT="multiselect",e.SWITCH="switch",e.CHECKBOX_GROUP="checkbox-group",e.MULTIDATE_SELECT="multidate-select",e.AREA_INPUT="area-input",e))(Ee||{}),Me=(e=>(e.BASIC_INFO="basic-info",e.MAP_CONFIG="map-config",e.ADDITIONAL_SETTINGS="additional-settings",e))(Me||{});const Le=[{id:"variableName",name:"variableName",inputType:Ee.SELECT,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.variableName",tooltip:"requests-form.variableNameTooltip",options:["geopotential","temperature"].map((e=>({value:e,label:ye(e)}))),validation:{required:!0}},{id:"years",name:"years",inputType:Ee.MULTIDATE_SELECT,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!1,label:"requests-form.years",tooltip:"requests-form.yearsTooltip",options:fe.map((e=>({value:e,label:e}))),defaultValue:[],validation:{required:!0}},{id:"yearsAdvanced",name:"years",inputType:Ee.CHECKBOX_GROUP,tabPlace:Me.BASIC_INFO,advancedField:!0,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.yearsAdvanced",tooltip:"requests-form.yearsAdvancedTooltip",options:ve.map((e=>({value:e,label:e}))),defaultValue:[],validation:{required:!0}},{id:"months",name:"months",inputType:Ee.MULTIDATE_SELECT,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.months",tooltip:"requests-form.monthsTooltip",options:be.map((e=>({value:Te(e),label:e}))),defaultValue:[],validation:{required:!0}},{id:"days",name:"days",inputType:Ee.MULTIDATE_SELECT,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.days",tooltip:"requests-form.daysTooltip",defaultValue:[],validation:{required:!0}},{id:"hours",name:"hours",inputType:Ee.CHECKBOX_GROUP,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.hours",tooltip:"requests-form.hoursTooltip",options:Ne.map((e=>({value:e,label:`${e.toString().padStart(2,"0")}:00`}))),defaultValue:[],validation:{required:!0}},{id:"pressureLevels",name:"pressureLevels",inputType:Ee.SELECT,tabPlace:Me.BASIC_INFO,advancedField:!1,optionalField:!1,showInAdvancedMode:!1,label:"requests-form.pressureLevels",tooltip:"requests-form.pressureLevelsTooltip",options:pe.map((e=>({value:e,label:`${e}hPa`}))),validation:{required:!0}},{id:"pressureLevelsAdvanced",name:"pressureLevels",inputType:Ee.MULTISELECT,tabPlace:Me.BASIC_INFO,advancedField:!0,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.pressureLevelsAdvanced",tooltip:"requests-form.pressureLevelsAdvancedTooltip",options:xe.map((e=>({value:e,label:`${e}hPa`}))),defaultValue:[],validation:{required:!0}},{id:"areaCovered",name:"areaCovered",inputType:Ee.AREA_INPUT,tabPlace:Me.MAP_CONFIG,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.areaCovered",tooltip:"requests-form.areaCoveredTooltip",defaultValue:"90,-180,-90,180",validation:{required:!0}},{id:"mapTypes",name:"mapTypes",inputType:Ee.CHECKBOX_GROUP,tabPlace:Me.MAP_CONFIG,advancedField:!1,optionalField:!1,showInAdvancedMode:!0,label:"requests-form.mapTypes",tooltip:"requests-form.mapTypesTooltip",options:["cont","disp","comb","forms"].map((e=>({value:e,label:e}))),validation:{required:!0}},{id:"mapLevels",name:"mapLevels",inputType:Ee.SELECT,tabPlace:Me.MAP_CONFIG,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.mapLevels",tooltip:"requests-form.mapLevelsTooltip",options:["10","15","20","25","30"].map((e=>({value:e,label:e}))),validation:{required:!0}},{id:"fileFormat",name:"fileFormat",inputType:Ee.SELECT,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!1,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.fileFormat",tooltip:"requests-form.fileFormatTooltip",options:["svg","png","jpg","jpeg","pdf"].map((e=>({value:e,label:e.toUpperCase()})))},{id:"noMaps",name:"noMaps",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.noMaps",tooltip:"requests-form.noMapsTooltip",defaultValue:!1},{id:"noData",name:"noData",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.noData",tooltip:"requests-form.noDataTooltip",defaultValue:!1},{id:"omp",name:"omp",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.omp",tooltip:"requests-form.ompTooltip",defaultValue:!1},{id:"nThreads",name:"nThreads",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.nThreads",tooltip:"requests-form.nThreadsTooltip",defaultValue:!1,dependencies:[{field:"omp",value:!0,condition:"equals"}]},{id:"mpi",name:"mpi",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.mpi",tooltip:"requests-form.mpiTooltip",defaultValue:!1},{id:"nProces",name:"nProces",inputType:Ee.SWITCH,tabPlace:Me.ADDITIONAL_SETTINGS,advancedField:!0,optionalField:!0,showInAdvancedMode:!0,label:"requests-form.nProces",tooltip:"requests-form.nProcesTooltip",defaultValue:!1,dependencies:[{field:"mpi",value:!0,condition:"equals"}]}];const Oe=({children:o,content:i,side:d="top",align:c="center",delay:m=0,className:u=""})=>e.jsx(s,{delayDuration:m,children:e.jsxs(a,{children:[e.jsx(t,{asChild:!0,children:o}),e.jsx(l,{children:e.jsxs(n,{side:d,align:c,className:`bg-slate-900 text-white px-3 py-1.5 text-xs leading-4 rounded-md z-50 max-w-xs \n                      shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out \n                      data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 ${u}`,sideOffset:5,children:[i,e.jsx(r,{className:"fill-slate-900"})]})})]})}),De=G.memo((({id:s,label:a,children:t,tooltip:l,error:n,required:r=!1,className:i=""})=>{const{t:d}=ce(),c=U.useMemo((()=>{if(!l)return null;const s=d("navigation-tooltips.help","Help");return e.jsx(Oe,{content:l,delay:200,children:e.jsx("button",{type:"button",className:"ml-1.5 rounded-full p-0.5 text-slate-400 hover:text-slate-600 \n                    focus:outline-none focus:ring-2 focus:ring-violet-500","aria-label":s,children:e.jsx(B,{size:14})})})}),[l,d]);return e.jsxs("div",{className:`mb-4 ${i}`,children:[e.jsxs("div",{className:"flex items-center mb-1.5",children:[e.jsxs(o,{htmlFor:s,className:"text-sm font-medium text-slate-700 cursor-pointer",children:[a,r&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),c]}),t,n&&e.jsx("p",{className:"mt-1.5 text-xs text-red-500 font-medium",children:n})]})}));function Pe(e,s){return"days"===s?"grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10":"hours"===s?"grid-cols-6":"years"===s?"grid-cols-10":e<=4?"grid-cols-2":e<=8?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"}const ke=G.memo((({config:s,value:a,error:t,formData:l,updateField:n,handleCheckboxChange:r})=>{var o;const{t:S}=ce(),[F,E]=U.useState(!1),[M,L]=U.useState(null),[O,D]=U.useState(!0),[P,k]=U.useState({up:"90",left:"-180",down:"-90",right:"180"}),_=U.useMemo((()=>{if("days"!==s.name)return s.options||[];const e=l.years||[],a=l.months||[];return je(e,a).map((e=>({value:e,label:e})))}),[s.name,l.years,l.months,s.options]);U.useEffect((()=>{if(s.inputType===Ee.AREA_INPUT&&a&&Array.isArray(a)&&4===a.length&&k({up:a[0],left:a[1],down:a[2],right:a[3]}),"pressureLevels"===s.name&&a)if("string"==typeof a){const e=a.split(",").map((e=>e.trim()));n("pressureLevels",e)}else Array.isArray(a)||n("pressureLevels",[])}),[s.inputType,s.name,a,s.defaultValue,n]),U.useEffect((()=>{if("days"===s.name&&Array.isArray(a)&&a.length>0){const e=l.years||[],s=l.months||[];if(0===e.length||0===s.length)return void n("days",[]);const t=je(e,s),r=a.filter((e=>t.includes(e)));r.length!==a.length&&n("days",r)}}),[l.years,l.months,s.name,a,n]);const $=function(e,s){return!e.dependencies||0===e.dependencies.length||e.dependencies.every((e=>{const a=s[e.field];switch(e.condition){case"equals":return a===e.value;case"notEquals":return a!==e.value;case"includes":return Array.isArray(a)&&a.includes(e.value);case"notIncludes":return Array.isArray(a)&&!a.includes(e.value);default:return!0}}))}(s,l);if(!$)return null;const G=(e,a)=>{const t={...P,[e]:a};k(t),n(s.name,[t.up,t.left,t.down,t.right])};return e.jsx(De,{id:s.id,label:s.label?S(s.label):s.name,tooltip:s.tooltip?S(s.tooltip):void 0,error:t,required:null==(o=s.validation)?void 0:o.required,children:(()=>{var t,o,k,$,U,H,V,B,ae;switch(s.inputType){case Ee.TEXT:return e.jsx("input",{id:s.id,type:"text",value:a||"",onChange:e=>n(s.name,e.target.value),placeholder:s.placeholder?S(s.placeholder):void 0,className:"mt-1.5 w-full rounded-md border border-slate-300 px-3 py-2 text-sm placeholder:text-slate-400 \n                      focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500"});case Ee.NUMBER:return e.jsx("input",{id:s.id,type:"number",value:a||"",onChange:e=>{const a=""===e.target.value?"":Number(e.target.value);n(s.name,a)},min:null==(t=s.validation)?void 0:t.minValue,max:null==(o=s.validation)?void 0:o.maxValue,placeholder:s.placeholder?S(s.placeholder):void 0,className:"mt-1.5 w-full rounded-md border border-slate-300 px-3 py-2 text-sm placeholder:text-slate-400 \n                      focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500"});case Ee.SELECT:let te=a;(Array.isArray(a)&&"pressureLevels"===s.name||"mapLevels"===s.name)&&(te=a.length>0?a[0]:"");const le=e=>{"pressureLevels"===s.name||"mapLevels"===s.name?n(s.name,[e]):n(s.name,e)};return e.jsxs(v,{value:te??"",onValueChange:le,children:[e.jsxs(b,{className:"inline-flex items-center justify-between w-full px-3 py-2 text-sm border border-slate-300 \n                      rounded-md shadow-sm bg-white focus:outline-none focus:ring-2 focus:ring-violet-500 \n                      focus:border-violet-500","aria-label":s.label?S(s.label):s.name,children:[e.jsx(g,{placeholder:s.placeholder?S(s.placeholder):S("requests-form.selectPlaceholder","Select an option")}),e.jsx(j,{children:e.jsx(K,{className:"w-4 h-4 text-slate-500"})})]}),e.jsx(N,{children:e.jsxs(y,{className:"overflow-hidden bg-white rounded-md shadow-lg border border-slate-200 z-50",children:[e.jsx(T,{className:"flex items-center justify-center h-6 bg-white text-slate-700 cursor-default",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(w,{className:"p-1",children:null==(k=s.options)?void 0:k.map((s=>e.jsxs(C,{value:s.value,className:"relative flex items-center h-8 px-6 text-sm rounded-md select-none \n                            hover:bg-violet-100 data-[highlighted]:outline-none data-[highlighted]:bg-violet-100",children:[e.jsx(I,{children:s.label}),e.jsx(A,{className:"absolute left-1 inline-flex items-center",children:e.jsx(W,{className:"w-4 h-4 text-violet-600"})})]},s.value)))}),e.jsx(q,{className:"flex items-center justify-center h-6 bg-white text-slate-700 cursor-default",children:e.jsx(K,{className:"w-4 h-4"})})]})})]});case Ee.MULTISELECT:const ne=Array.isArray(a)?a:[],re=e=>{const a=ne.includes(e)?ne.filter((s=>s!==e)):[...ne,e];n(s.name,a)};return e.jsx("div",{className:"mt-1.5 space-y-3",children:e.jsxs(c,{open:F,onOpenChange:E,children:[e.jsx(m,{asChild:!0,children:e.jsxs("button",{type:"button",className:"inline-flex items-center justify-between w-full px-3 py-2 text-sm border border-slate-300 \n                          rounded-md shadow-sm bg-white focus:outline-none focus:ring-2 focus:ring-violet-500 \n                          focus:border-violet-500 disabled:bg-slate-100 disabled:text-slate-400 disabled:border-slate-200",children:[e.jsx("span",{className:"inline-flex items-center",children:e.jsx("span",{className:"truncate",children:0===ne.length?S(s.placeholder?s.placeholder:`requests-form.select${s.name}`,s.placeholder?S(s.placeholder):`Select ${s.name}`):ne.length<=2?ne.map((e=>{var a,t;return(null==(t=null==(a=s.options)?void 0:a.find((s=>s.value===e)))?void 0:t.label)||e})).join(", "):ne.length+" "+S("requests-form.itemsSelected",{count:ne.length,defaultValue:"{{count}} selected"})})}),e.jsx(K,{className:"w-4 h-4 text-slate-500"})]})}),e.jsx(u,{children:e.jsxs(h,{className:"bg-white p-3 rounded-md shadow-lg border border-slate-200 max-w-m max-h-70 overflow-y-auto z-50 p-7",sideOffset:5,align:"start",children:[((null==($=s.options)?void 0:$.length)??0)>0?e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2 gap-x-4",children:null==(U=s.options)?void 0:U.map((a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{id:`${s.id}-${a.value}`,checked:ne.includes(a.value),onCheckedChange:()=>re(a.value),className:"h-4 w-4 rounded border border-slate-300 bg-white\n                              data-[state=checked]:bg-violet-600 data-[state=checked]:border-violet-600 \n                              focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-1",children:e.jsx(d,{className:"flex items-center justify-center text-white",children:e.jsx(W,{className:"h-3 w-3"})})}),e.jsx("label",{htmlFor:`${s.id}-${a.value}`,className:"text-sm text-slate-700 cursor-pointer",children:a.label})]},a.value)))}):e.jsx("div",{className:"py-2 text-center text-slate-500 text-sm",children:S("requests-form.noOptionsAvailable","No options available")}),e.jsx(p,{className:"absolute top-2 right-2 rounded-full p-1 inline-flex items-center justify-center text-slate-400 hover:text-slate-500","aria-label":"Close",children:e.jsx(Q,{className:"h-4 w-4"})})]})})]})});case Ee.SWITCH:return e.jsx("div",{className:"flex items-center h-5",children:e.jsx(x,{id:s.id,checked:!!a,onCheckedChange:e=>n(s.name,e),className:"w-10 h-5 bg-slate-300 rounded-full relative data-[state=checked]:bg-violet-600",children:e.jsx(f,{className:"block w-4 h-4 bg-white rounded-full transition-transform duration-100 \n                           transform translate-x-0.5 will-change-transform data-[state=checked]:translate-x-5"})})});case Ee.CHECKBOX_GROUP:return e.jsx("div",{className:`grid ${Pe((null==(H=s.options)?void 0:H.length)??0,s.name)} gap-2 mt-1.5 \n                         ${"days"===s.name?"max-h-48 overflow-y-auto border border-slate-200 rounded-md p-2":""}`,children:null==(V=s.options)?void 0:V.map((t=>e.jsxs("label",{className:"flex items-center space-x-2 text-sm text-slate-700 cursor-pointer",children:[e.jsx(i,{id:`${s.id}-${t.value}`,checked:Array.isArray(a)&&a.includes(t.value),onCheckedChange:e=>null==r?void 0:r(s.name,t.value,e),className:"h-4 w-4 rounded border border-slate-300 bg-white\n                          data-[state=checked]:bg-violet-600 data-[state=checked]:border-violet-600 \n                          focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-1",children:e.jsx(d,{className:"flex items-center justify-center text-white",children:e.jsx(W,{className:"h-3 w-3"})})}),e.jsx("span",{children:"mapTypes"===s.name?S(`mapTypes-list.${t.label}`):t.label})]},t.value)))});case Ee.MULTIDATE_SELECT:const oe=Array.isArray(a)?a:[],ie="days"===s.name?_:s.options||[],de=e=>{const a=oe.includes(e)?oe.filter((s=>s!==e)):[...oe,e];n(s.name,a)},ce=e=>0===oe.length?S(`requests-form.select${e}`,`Select ${e}`):oe.length<=2?oe.join(", "):oe.length+" "+S("requests-form.itemsSelected",{count:oe.length,defaultValue:"{{count}} selected"}),me=s=>{switch(s){case"years":case"days":return e.jsx(se,{className:"w-4 h-4 mr-2"});case"months":return e.jsx(ee,{className:"w-4 h-4 mr-2"});case"hours":return e.jsx(J,{className:"w-4 h-4 mr-2"})}},ue="days"!==s.name||((null==(B=l.years)?void 0:B.length)??0)>0&&((null==(ae=l.months)?void 0:ae.length)??0)>0,he=ue||"days"!==s.name?S(`requests-form.select${ye(s.name)}`,`Select ${s.name}`):S("requests-form.selectYearsAndMonthsFirst","Select years and months first");return e.jsx("div",{className:"mt-1.5 space-y-3",children:e.jsxs(c,{open:M===s.name,onOpenChange:e=>L(e?s.name:null),children:[e.jsx(m,{asChild:!0,children:e.jsxs("button",{type:"button",disabled:!ue&&"days"===s.name,className:"inline-flex items-center justify-between w-full px-3 py-2 text-sm border border-slate-300 \n                          rounded-md shadow-sm bg-white focus:outline-none focus:ring-2 focus:ring-violet-500 \n                          focus:border-violet-500 disabled:bg-slate-100 disabled:text-slate-400 disabled:border-slate-200",children:[e.jsxs("span",{className:"inline-flex items-center",children:[me(s.name),e.jsx("span",{className:"truncate",children:oe.length>0?ce(s.name):he})]}),e.jsx(K,{className:"w-4 h-4 text-slate-500"})]})}),e.jsx(u,{children:e.jsxs(h,{className:"bg-white p-3 rounded-md shadow-lg border border-slate-200 max-w-m max-h-70 overflow-y-auto z-50 p-7",sideOffset:5,align:"start",children:[ie.length>0?e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2 gap-x-4",children:ie.map((a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{id:`${s.id}-${a.value}`,checked:oe.includes(a.value),onCheckedChange:()=>de(a.value),className:"h-4 w-4 rounded border border-slate-300 bg-white\n                                  data-[state=checked]:bg-violet-600 data-[state=checked]:border-violet-600 \n                                  focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-1",children:e.jsx(d,{className:"flex items-center justify-center text-white",children:e.jsx(W,{className:"h-3 w-3"})})}),e.jsx("label",{htmlFor:`${s.id}-${a.value}`,className:"text-sm text-slate-700 cursor-pointer",children:"months"===s.name?S(`months-list.${a.label}`):a.label})]},a.value)))}):e.jsx("div",{className:"py-2 text-center text-slate-500 text-sm",children:S("requests-form.noOptionsAvailable","No options available")}),e.jsx(p,{className:"absolute top-2 right-2 rounded-full p-1 inline-flex items-center justify-center text-slate-400 hover:text-slate-500","aria-label":"Close",children:e.jsx(Q,{className:"h-4 w-4"})})]})})]})});case Ee.AREA_INPUT:return e.jsxs("div",{className:"mt-1.5 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{id:`${s.id}-default`,defaultChecked:!0,onCheckedChange:e=>(e=>{if(D(e),e){let e=s.defaultValue;"string"==typeof e&&(e=e.split(",").map((e=>e.trim())));const a=["90","-180","-90","180"];n(s.name,e||a)}else n(s.name,[P.up,P.left,P.down,P.right])})(e),className:"h-4 w-4 rounded border border-slate-300 bg-white\n                        data-[state=checked]:bg-violet-600 data-[state=checked]:border-violet-600 \n                        focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-1",children:e.jsx(d,{className:"flex items-center justify-center text-white",children:e.jsx(W,{className:"h-3 w-3"})})}),e.jsx("label",{htmlFor:`${s.id}-default`,className:"text-sm text-slate-700",children:S("requests-form.useDefaultArea","Use default area")})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 "+(O?"opacity-50 pointer-events-none":""),children:[e.jsx("div",{className:"col-start-2 flex items-end justify-center",children:e.jsx("input",{type:"number",value:P.up,onChange:e=>G("up",e.target.value),min:"-90",max:"90",disabled:O,className:"w-full text-center rounded-md border border-slate-300 px-2 py-1 text-sm \n                           focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"North (-90-90)"})}),e.jsx("div",{className:"col-start-1 row-start-2 flex items-center justify-end",children:e.jsx("input",{type:"number",value:P.left,onChange:e=>G("left",e.target.value),min:"-180",max:"180",disabled:O,className:"w-full text-center rounded-md border border-slate-300 px-2 py-1 text-sm \n                           focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"West (-180-180)"})}),e.jsx("div",{className:"col-start-2 row-start-2 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-14 h-14 flex items-center justify-center",children:[e.jsx(R,{className:"absolute top-0 left-1/2 -translate-x-1/2 w-5 h-5 text-violet-600"}),e.jsx(z,{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-5 h-5 text-violet-600"}),e.jsx(Y,{className:"absolute left-0 top-1/2 -translate-y-1/2 w-5 h-5 text-violet-600"}),e.jsx(X,{className:"absolute right-0 top-1/2 -translate-y-1/2 w-5 h-5 text-violet-600"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:e.jsx("div",{className:"w-4 h-4 rounded-full bg-violet-700 border-2 border-violet-300 shadow-sm"})})]})}),e.jsx("div",{className:"col-start-3 row-start-2 flex items-center justify-start",children:e.jsx("input",{type:"number",value:P.right,onChange:e=>G("right",e.target.value),min:"-180",max:"180",disabled:O,className:"w-full text-center rounded-md border border-slate-300 px-2 py-1 text-sm \n                           focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"East (-180-180)"})}),e.jsx("div",{className:"col-start-2 row-start-3 flex items-start justify-center",children:e.jsx("input",{type:"number",value:P.down,onChange:e=>G("down",e.target.value),min:"-90",max:"90",disabled:O,className:"w-full text-center rounded-md border border-slate-300 px-2 py-1 text-sm \n                           focus:outline-none focus:ring-2 focus:ring-violet-500 focus:border-violet-500",placeholder:"South (-90-90)"})})]}),e.jsx("p",{className:"text-xs text-slate-500",children:S("requests-form.areaInputHelp","Coordinates in degrees: North (-90-90), West (-180-180), South (-90-90), East (-180-180)")})]});default:return e.jsxs("div",{children:["Unsupported field type: ",s.inputType]})}})()})})),_e=G.memo((({tabName:s,formData:a,updateFormField:t,handleCheckboxChange:l,advancedMode:n,onNext:r,onPrevious:o,t:i})=>{const[d,c]=U.useState({}),m=U.useMemo((()=>function(e,s=!1){return Le.filter((a=>{const t=a.tabPlace===e,l=!a.advancedField||a.advancedField&&s;return t&&l}))}(s,n)),[s,n]),u=U.useCallback((()=>{const e={};let s=!0;return m.forEach((t=>{var l;if(!t.optionalField&&(null==(l=t.validation)?void 0:l.required)){const l=a[t.name];(!l||Array.isArray(l)&&0===l.length)&&(e[t.name]=i("requests-form.required"),s=!1)}})),c(e),s}),[a,m,i]),h=U.useCallback((()=>{u()&&r()}),[u,r]),p=U.useMemo((()=>e.jsxs("div",{className:"flex justify-between",children:[o&&e.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-slate-700 \n                    bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2\n                    transition-colors duration-200",children:i("buttons.back")}),e.jsx("div",{className:o?"":"ml-auto",children:e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700 \n                    focus:outline-none focus:ring-2 focus:ring-violet-500 focus:ring-offset-2\n                    transition-colors duration-200",children:i("buttons.next","Next")})})]})),[o,h,i]),x=U.useMemo((()=>{const e=m.filter((e=>!n||!1!==e.showInAdvancedMode));return s===Me.ADDITIONAL_SETTINGS&&n?{regular:e.filter((e=>!["omp","nThreads","mpi","nProces"].includes(e.id))),parallel:e.filter((e=>["omp","nThreads","mpi","nProces"].includes(e.id)))}:{regular:e,parallel:[]}}),[m,s,n]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:(()=>{switch(s){case Me.BASIC_INFO:return i("requests-titles.basicInfo");case Me.MAP_CONFIG:return i("requests-titles.mapConfig");case Me.ADDITIONAL_SETTINGS:return i("requests-titles.additionalSettings","Additional Settings");default:return""}})()}),e.jsx("div",{className:s===Me.MAP_CONFIG?"grid grid-cols-1 md:grid-cols-2 gap-6":"",children:x.regular.map((s=>e.jsx(ke,{config:s,value:a[s.name],error:d[s.name],formData:a,updateField:t,handleCheckboxChange:l},s.id)))}),s===Me.ADDITIONAL_SETTINGS&&n?e.jsx("div",{className:"border-t border-slate-200 pt-4 mt-4",children:e.jsx("h3",{className:"text-lg font-medium mb-3 text-slate-900",children:i("requests-form.parallelProcessingOptions","Parallel Processing Options")})}):null,s===Me.ADDITIONAL_SETTINGS&&n&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.parallel.map((s=>e.jsx(ke,{config:s,value:a[s.name],error:d[s.name],formData:a,updateField:t,handleCheckboxChange:l},s.id)))}),p]})})),$e=G.memo((({advancedMode:s,showToast:a,t:t})=>{const l=H(),{formData:n,isSubmitting:r,updateField:o,handleSubmit:i,clearForm:d,handleCheckboxChange:c}=(e=>{const s=re(),[a,t]=U.useState(!1),l=oe((e=>e.submitRequests.form)),n=U.useCallback(((e,a)=>{s(ie({field:e,value:a??""}))}),[s]),r=U.useCallback((async()=>{t(!0);try{const a=await s(de(l)).unwrap();return t(!1),{success:!0,message:e("requests-titles.success"),requestHash:a.requestHash}}catch(a){return t(!1),{success:!1,error:a,message:`${e("errors.title")}: ${a instanceof Error?a.message:e("errors.submission")}`}}}),[s,l,e]),o=U.useCallback((()=>(Object.keys(l).forEach((e=>{const a=e;let t;t=Array.isArray(l[a])?[]:"boolean"!=typeof l[a]&&"",s(ie({field:a,value:t}))})),{success:!0,message:e("requests-titles.clearSuccess")})),[s,l,e]),i=U.useCallback(((e,s,a)=>{if("boolean"!=typeof a)return;const t=Array.isArray(l[e])?l[e]:[];a?t.includes(s)||n(e,[...t,s]):t.includes(s)&&n(e,t.filter((e=>e!==s)))}),[l,n]);return{formData:l,isSubmitting:a,updateField:n,handleSubmit:r,clearForm:o,handleCheckboxChange:i}})(t),{activeTab:m,setActiveTab:u,goToNextTab:h,goToPreviousTab:p}=((e=he[0])=>{const[s,a]=U.useState(e),t=U.useCallback((e=>{const s=he.indexOf(e);s<he.length-1&&a(he[s+1])}),[]),l=U.useCallback((e=>{const s=he.indexOf(e);s>0&&a(he[s-1])}),[]);return{activeTab:s,setActiveTab:U.useCallback((e=>{he.includes(e)&&a(e)}),[]),goToNextTab:t,goToPreviousTab:l}})(),x=U.useMemo((()=>e.jsx(_e,{tabName:Me.BASIC_INFO,formData:n,updateFormField:o,handleCheckboxChange:c,advancedMode:s,onNext:()=>h("basicInfo"),t:t})),[n,o,c,s,h,t]),f=U.useMemo((()=>e.jsx(_e,{tabName:Me.MAP_CONFIG,formData:n,updateFormField:o,handleCheckboxChange:c,advancedMode:s,onNext:()=>h("mapConfig"),onPrevious:()=>p("mapConfig"),t:t})),[n,o,c,s,h,p,t]),v=U.useMemo((()=>e.jsx(_e,{tabName:Me.ADDITIONAL_SETTINGS,formData:n,updateFormField:o,handleCheckboxChange:c,advancedMode:s,onNext:()=>h("additionalSettings"),onPrevious:()=>p("additionalSettings"),t:t})),[n,o,c,s,h,p,t]),b=U.useMemo((()=>e.jsx(Fe,{formData:n,onPrevious:()=>p("summary"),t:t})),[n,p,t]);return e.jsxs(S,{value:m,onValueChange:u,className:"tabs-container w-full",children:[e.jsx(F,{className:"tabs-list flex","aria-label":t("requests-form.formSteps","Request form steps"),children:he.map(((s,a)=>e.jsxs(E,{value:s,className:"tab-trigger",children:[a+1,". ",t(`requests-titles.${s.replace("-","")}`,s)]},s)))}),e.jsxs("div",{className:"form-container",children:[e.jsx(M,{value:"basicInfo",className:"tab-content",children:x}),e.jsx(M,{value:"mapConfig",className:"tab-content",children:f}),e.jsx(M,{value:"additionalSettings",className:"tab-content",children:v}),e.jsxs(M,{value:"summary",className:"tab-content",children:[b,e.jsx(L,{className:"h-px bg-slate-200 my-6"}),e.jsxs("div",{className:"actions-container",children:[e.jsx("button",{type:"button",onClick:()=>{const e=d();a(e.message,e.success?"success":"info")},className:"secondary-button flex items-center justify-center",disabled:r,"aria-label":t("requests-titles.clear"),children:t("requests-titles.clear")}),e.jsx("button",{type:"button",onClick:async()=>{const e=await i();a(e.message,e.success?"success":"error"),e.success&&e.requestHash&&l(`/results?requestHash=${e.requestHash}`)},className:"primary-button flex items-center justify-center",disabled:r,"aria-label":t("requests-titles.submit"),children:r?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"animate-spin mr-2",size:18}),e.jsx("span",{children:t("requests-form.submitting","Submitting...")})]}):t("requests-titles.submit")})]})]})]})]})})),Ge=G.memo((({advancedMode:s,setAdvancedMode:a,t:t})=>e.jsxs("div",{className:"mode-toggle",children:[e.jsx("label",{htmlFor:"advanced-mode",className:"mode-label text-sm font-medium text-slate-700",children:t("requests-form.advancedMode","Advanced Mode")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{id:"advanced-mode",checked:s,onCheckedChange:a,className:"switch-root","aria-label":t("requests-form.toggleAdvancedMode","Toggle advanced mode"),children:e.jsx(f,{className:"switch-thumb"})}),e.jsx(Oe,{content:t("requests-form.advancedModeTooltip","Enable advanced mode to access additional configuration options"),children:e.jsx("button",{type:"button",className:"text-slate-400 hover:text-slate-600 transition-colors duration-200","aria-label":t("navigation-tooltips.help","Help"),children:e.jsx(B,{size:16})})})]})]}))),Ue=({open:s,onOpenChange:a,message:t,title:l,type:n="info",duration:r=5e3})=>{const{t:o}=ce(),i={success:o("toast.success","Success"),error:o("toast.error","Error"),warning:o("toast.warning","Warning"),info:o("toast.info","Information")},d={success:ne,error:V,warning:le,info:te}[n];return e.jsxs(O,{swipeDirection:"right",children:[e.jsxs(D,{className:`toast-root toast-type-${n}`,open:s,onOpenChange:a,duration:r,children:[e.jsx("div",{className:"toast-icon-container",children:e.jsx(d,{className:`toast-icon toast-icon-${n}`,size:18})}),e.jsxs("div",{className:"toast-content",children:[e.jsx(P,{className:"toast-title",children:l??i[n]}),e.jsx(k,{className:"toast-description",children:t})]}),e.jsx(_,{className:"toast-close",asChild:!0,altText:o("buttons.close"),children:e.jsx("button",{"aria-label":o("buttons.close"),children:e.jsx(Q,{size:14})})})]}),e.jsx($,{className:"toast-viewport"})]})},He=G.memo((()=>{const{t:s}=ce(),{isAuthenticated:a}=me(),[t,l]=U.useState(!1),{isOpen:n,setIsOpen:r,message:o,type:i,title:d,showToast:c}=(()=>{const[e,s]=U.useState({isOpen:!1,message:"",type:"info"}),a=(e,a="info",t)=>{s({isOpen:!0,message:e,type:a,title:t})};return{...e,setIsOpen:e=>{s((s=>({...s,isOpen:e})))},showToast:a,showSuccess:(e,s)=>a(e,"success",s),showError:(e,s)=>a(e,"error",s),showWarning:(e,s)=>a(e,"warning",s),showInfo:(e,s)=>a(e,"info",s)}})();return e.jsxs("div",{className:"request-container container mx-auto px-4 sm:px-6 py-6 sm:py-8 bg-white shadow-lg rounded-xl",children:[e.jsxs("div",{className:"header-container flex items-center justify-between",children:[e.jsx("h1",{className:"page-title",children:s("requests-titles.title")}),e.jsx(Ge,{advancedMode:t,setAdvancedMode:l,t:s})]}),!a&&e.jsx(ue,{t:s}),e.jsx($e,{advancedMode:t,showToast:c,t:s}),e.jsx(Ue,{open:n,onOpenChange:r,message:o,type:i,title:d})]})}));export{He as default};
