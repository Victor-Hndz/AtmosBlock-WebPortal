import{j as e,B as s,w as a,x as t,y as r,z as l,M as i,S as n,J as d,ae as c,af as o,ag as m,K as x,N as u,O as h,ah as p,ai as j,D as f,E as b,G as g,aj as N,V as y}from"./ui-DsGTuYJt.js";import{l as v,r as w,N as C}from"./vendor-DMwOp_gx.js";import{a as z,u as S,e as k,f as M,g as O,c as q}from"./index-B-JNh-Hw.js";import{u as E}from"./i18n-BPcgiOnt.js";import{w as T,X as D,x as I,U as R,f as A,y as B,z as G,T as J}from"./icons-Cb89orYe.js";const K=()=>{const{t:K}=E(),L=v(),P=z(),{user:U,isAuthenticated:V}=S((e=>e.auth)),{isLoading:$,error:F,successMessage:H}=S((e=>e.user)),[Q,W]=w.useState(!1),[X,Y]=w.useState(""),[Z,_]=w.useState(""),[ee,se]=w.useState(!1),[ae,te]=w.useState("success"),[re,le]=w.useState(""),[ie,ne]=w.useState(!1);if(w.useEffect((()=>{U&&(Y(U.name),_(U.email))}),[U]),w.useEffect((()=>{H&&(te("success"),le(H),se(!0),setTimeout((()=>{P(k())}),3e3))}),[H,P]),w.useEffect((()=>{F&&(te("error"),le(F),se(!0),setTimeout((()=>{P(k())}),3e3))}),[F,P]),!V||!U)return e.jsx(C,{to:"/auth",replace:!0});return e.jsxs(s,{swipeDirection:"right",children:[e.jsxs("div",{className:"max-w-3xl mx-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:K("profile.profile")}),!Q&&e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors","aria-label":K("profile.editProfile"),children:[e.jsx(T,{size:16}),e.jsx("span",{children:K("profile.edit")})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:K("profile.userInformation")}),Q?e.jsxs(a,{className:"space-y-4",onSubmit:e=>{e.preventDefault();const s={};X!==U.name&&(s.name=X),Z!==U.email&&(s.email=Z),Object.keys(s).length>0?P(M(s)).unwrap().then((()=>{W(!1)})):W(!1)},children:[e.jsxs(t,{name:"name",className:"space-y-2",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",children:K("profile.name")}),e.jsx(l,{asChild:!0,children:e.jsx("input",{type:"text",required:!0,value:X,onChange:e=>Y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx(i,{match:"valueMissing",className:"text-sm text-red-600",children:K("profile.nameRequired")})]}),e.jsxs(t,{name:"email",className:"space-y-2",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",children:K("profile.email")}),e.jsx(l,{asChild:!0,children:e.jsx("input",{type:"email",required:!0,value:Z,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx(i,{match:"valueMissing",className:"text-sm text-red-600",children:K("profile.emailRequired")}),e.jsx(i,{match:"typeMismatch",className:"text-sm text-red-600",children:K("profile.emailInvalid")})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsxs("button",{type:"button",onClick:()=>{Y(U.name),_(U.email),W(!1)},className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",disabled:$,children:[e.jsx(D,{size:16}),e.jsx("span",{children:K("buttons.cancel")})]}),e.jsx(n,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors disabled:opacity-50",disabled:$,children:[e.jsx(I,{size:16}),e.jsx("span",{children:K($?"buttons.saving":"buttons.save")})]})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(R,{className:"mt-1 mr-3 text-gray-500",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:K("profile.name")}),e.jsx("p",{className:"font-medium",children:U.name})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(A,{className:"mt-1 mr-3 text-gray-500",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:K("profile.email")}),e.jsx("p",{className:"font-medium",children:U.email})]})]}),U.role&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(B,{className:"mt-1 mr-3 text-gray-500",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:K("profile.role")}),e.jsx("p",{className:"font-medium",children:U.role})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:K("profile.accountOptions")}),e.jsxs("button",{onClick:()=>L("/settings"),className:"w-full mb-3 px-4 py-2 border border-gray-300 rounded-md text-left hover:bg-gray-50 transition-colors flex items-center",children:[e.jsx("span",{className:"flex-1",children:K("profile.viewRequests")}),e.jsx("span",{className:"text-gray-400",children:"→"})]}),e.jsxs(d,{open:ie,onOpenChange:ne,children:[e.jsx(c,{asChild:!0,children:e.jsxs("button",{className:"w-full px-4 py-2 border border-red-300 rounded-md text-left text-red-600 hover:bg-red-50 transition-colors flex items-center gap-2",children:[e.jsx(G,{size:16}),e.jsx("span",{children:K("profile.deleteAccount")})]})}),e.jsxs(o,{children:[e.jsx(m,{className:"fixed inset-0 bg-black/50 data-[state=open]:animate-fade-in"}),e.jsxs(x,{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90vw] max-w-md bg-white rounded-lg p-6 shadow-lg data-[state=open]:animate-slide-up",children:[e.jsxs(u,{className:"text-xl font-semibold text-red-600 mb-2 flex items-center gap-2",children:[e.jsx(J,{}),K("profile.deleteConfirmTitle")]}),e.jsx(h,{className:"text-gray-700 mb-5",children:K("profile.deleteConfirmMessage")}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(p,{asChild:!0,children:e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:K("buttons.cancel")})}),e.jsx(j,{asChild:!0,children:e.jsx("button",{onClick:()=>{P(O()).unwrap().then((()=>{P(q()),L("/")}))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:$,children:K($?"buttons.deleting":"buttons.delete")})})]})]})]})]})]})]}),e.jsxs(f,{className:`fixed bottom-4 right-4 p-4 rounded-md shadow-md max-w-sm ${"success"===ae?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"} data-[state=open]:animate-slideIn data-[state=closed]:animate-slideOut`,open:ee,onOpenChange:se,children:[e.jsx(b,{className:"font-medium "+("success"===ae?"text-green-800":"text-red-800"),children:K("success"===ae?"toast.success":"toast.error")}),e.jsx(g,{className:"success"===ae?"text-green-700":"text-red-700",children:re}),e.jsx(N,{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600",children:"×"})]}),e.jsx(y,{})]})};export{K as default};
